{% comment %}
  Component: Individual Card Item
  
  Parameters:
  - card: block object with settings (required)
  - layout: 'grid', 'horizontal', 'pyramid' (default: 'grid')
  - hide_description: boolean (default: false)
  - index: number (for animations)
{% endcomment %}

{%- liquid
  assign layout = layout | default: 'grid'
  assign hide_description = hide_description | default: false
  assign show_bullets = card.settings.show_bullets | default: false
  assign bullet_points = card.settings.bullet_points | split: ','
-%}

<div class="card-item" 
     data-index="{{ index }}" 
     data-layout="{{ layout }}"
     data-block-id="{{ card.id }}" 
     {{ card.shopify_attributes }}>
  
  <!-- Card Image -->
  <div class="card-item__image">
    {% if card.settings.card_image != blank %}
      <img 
        src="{{ card.settings.card_image | image_url: width: 400 }}" 
        srcset="{{ card.settings.card_image | image_url: width: 200 }} 200w,
                {{ card.settings.card_image | image_url: width: 300 }} 300w,
                {{ card.settings.card_image | image_url: width: 400 }} 400w,
                {{ card.settings.card_image | image_url: width: 600 }} 600w"
        sizes="(max-width: 768px) 200px, 300px"
        alt="{{ card.settings.card_title | default: 'Card image' | escape }}"
        class="card-item__image-element"
        loading="lazy"
        width="300"
        height="300">
    {% else %}
      <div class="card-item__image-placeholder">
        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
          <circle cx="8.5" cy="8.5" r="1.5"></circle>
          <polyline points="21,15 16,10 5,21"></polyline>
        </svg>
      </div>
    {% endif %}
  </div>
  
  <!-- Card Content -->
  <div class="card-item__content">
    {% if card.settings.card_title != blank %}
      <h3 class="card-item__title">{{ card.settings.card_title }}</h3>
    {% endif %}
    
    {% if card.settings.card_description != blank and hide_description == false %}
      <p class="card-item__description">{{ card.settings.card_description }}</p>
    {% endif %}
    
    <!-- Bullet Points -->
    {% if show_bullets and bullet_points.size > 0 %}
      <div class="card-item__bullets">
        {% for bullet_text in bullet_points %}
          {%- assign trimmed_bullet = bullet_text | strip -%}
          {% if trimmed_bullet != blank %}
            <div class="card-item__bullet{% if card.settings.bullet_container %} card-item__bullet--container{% endif %}">
              <div class="card-item__bullet-icon">
                {% if card.settings.bullet_icon != blank %}
                  {{ card.settings.bullet_icon }}
                {% else %}
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor">
                    <path d="M225.86,102.82c-3.77-3.94-7.67-8-9.14-11.57-1.36-3.27-1.44-8.69-1.52-13.94-.15-9.76-.31-20.82-8-28.51s-18.75-7.85-28.51-8c-5.25-.08-10.67-.16-13.94-1.52-3.56-1.47-7.63-5.37-11.57-9.14C146.28,23.51,138.44,16,128,16s-18.27,7.51-25.18,14.14c-3.94,3.77-8,7.67-11.57,9.14C88,40.64,82.56,40.72,77.31,40.8c-9.76.15-20.82.31-28.51,8S41,67.55,40.8,77.31c-.08,5.25-.16,10.67-1.52,13.94-1.47,3.56-5.37,7.63-9.14,11.57C23.51,109.72,16,117.56,16,128s7.51,18.27,14.14,25.18c3.77,3.94,7.67,8,9.14,11.57,1.36,3.27,1.44,8.69,1.52,13.94.15,9.76.31,20.82,8,28.51s18.75,7.85,28.51,8c5.25.08,10.67.16,13.94,1.52,3.56,1.47,7.63,5.37,11.57,9.14C109.72,232.49,117.56,240,128,240s18.27-7.51,25.18-14.14c3.94-3.77,8-7.67,11.57-9.14,3.27-1.36,8.69-1.44,13.94-1.52,9.76-.15,20.82-.31,28.51-8s7.85-18.75,8-28.51c.08-5.25.16-10.67,1.52-13.94,1.47-3.56,5.37-7.63,9.14-11.57C232.49,146.28,240,138.44,240,128S232.49,109.73,225.86,102.82Zm-52.2,6.84-56,56a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,148.69l50.34-50.35a8,8,0,0,1,11.32,11.32Z"/>
                  </svg>
                {% endif %}
              </div>
              <span class="card-item__bullet-text">{{ trimmed_bullet }}</span>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}
  </div>
</div>